<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:fragment="layout(title, content, styles, scripts)">
<head>
    <meta charset="UTF-8">
    <title th:text="${title}">Auvier</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Admin Stylesheet -->
    <link rel="stylesheet" th:href="@{/assets/admin/css/admin.css}">

    <!-- Page-specific CSS path (optional) -->
    <link th:if="${styles != null}"
          rel="stylesheet"
          th:href="@{${styles}}">
</head>

<body class="v-shell">

<!-- Top Bar -->
<header class="v-topbar">
    <div class="v-topbar__inner">
        <!-- Left: Brand (text only) -->
        <a class="v-brand v-brand--text-only" th:href="@{/admin}">
            <span class="v-brand__text">Auvier</span>
        </a>

        <!-- Center: Navigation -->
        <nav class="v-topnav">
            <a class="v-topnav__link" th:href="@{/admin}">Dashboard</a>
            <a class="v-topnav__link" th:href="@{/admin/orders}">Orders</a>
            <a class="v-topnav__link" th:href="@{/admin/categories}">Categories</a>
            <a class="v-topnav__link" th:href="@{/admin/products}">Products</a>
            <a class="v-topnav__link" th:href="@{/admin/users}">Users</a>
        </nav>

        <!-- Right: Profile Dropdown -->
        <div class="v-topbar__actions">

            <!-- Admin Profile Dropdown -->
            <div class="v-admin-profile">
                <button type="button" class="v-admin-profile__trigger" onclick="toggleAdminProfile()">
                    <span class="v-admin-profile__avatar">A</span>
                    <span class="v-admin-profile__name" sec:authentication="name">Admin</span>
                    <i class="bi bi-chevron-down"></i>
                </button>

                <div class="v-admin-profile__dropdown" id="adminProfileDropdown">
                    <div class="v-admin-profile__header">
                        <div class="v-admin-profile__info">
                            <span class="v-admin-profile__fullname" sec:authentication="name">Admin</span>
                            <span class="v-admin-profile__role">Administrator</span>
                        </div>
                    </div>

                    <div class="v-admin-profile__section">
                        <div class="v-admin-profile__section-header" onclick="toggleActivityLog()">
                            <span><i class="bi bi-clock-history"></i> My Activity</span>
                            <i class="bi bi-chevron-down" id="activityChevron"></i>
                        </div>
                        <div class="v-admin-profile__activity" id="activityLogPanel" style="display: none;">
                            <div class="v-admin-profile__activity-loading" id="activityLoading">
                                <i class="bi bi-arrow-repeat"></i> Loading...
                            </div>
                            <div class="v-admin-profile__activity-list" id="activityList"></div>
                            <a th:href="@{/admin/activity}" class="v-admin-profile__activity-link">
                                View All Activity <i class="bi bi-arrow-right"></i>
                            </a>
                        </div>
                    </div>

                    <div class="v-admin-profile__footer">
                        <form th:action="@{/logout}" method="post">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            <button type="submit" class="v-admin-profile__logout">
                                <i class="bi bi-box-arrow-right"></i> Sign Out
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main -->
<main class="v-main">
    <th:block th:replace="${content}"></th:block>
</main>

<!-- Footer -->
<footer class="v-footer">
    <div class="v-footer__inner">
        <span>© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> Auvier</span>
        <span class="v-footer__dot">•</span>
        <span class="v-footer__muted">House of Advancement</span>
    </div>
</footer>

<!-- Bootstrap JS (for dropdowns if needed) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Admin JS -->
<script th:src="@{/assets/admin/js/admin.js}"></script>

<!-- Page-specific scripts (optional) -->
<th:block th:if="${scripts != null}">
    <th:block th:replace="${scripts}"></th:block>
</th:block>

